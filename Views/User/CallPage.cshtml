@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head><script src="http://static.opentok.com/webrtc/v2.0/js/TB.min.js"></script></head>


<script type="text/javascript">
    var apiKey = "44625932";
    var sessionId = "2_MX40NDYyNTkzMn5-RnJpIEphbiAyNCAxNjoyNzoxNCBQU1QgMjAxNH4wLjAwODQwMjI4OH4";
    var token = "T1==cGFydG5lcl9pZD00NDYyNTkzMiZzZGtfdmVyc2lvbj10YnJ1YnktdGJyYi12MC45MS4yMDExLTAyLTE3JnNpZz0xYTRjODllMjhlZjE1ODc1ZmQ5YzgzMGJkYjNiOTM3ODc5NjI5YWVmOnJvbGU9c3Vic2NyaWJlciZzZXNzaW9uX2lkPTJfTVg0ME5EWXlOVGt6TW41LVJuSnBJRXBoYmlBeU5DQXhOam95TnpveE5DQlFVMVFnTWpBeE5INHdMakF3T0RRd01qSTRPSDQmY3JlYXRlX3RpbWU9MTM5MDYwOTY1NSZub25jZT0wLjA4NzQ4NjUxNTQwNzU5OTQ0JmV4cGlyZV90aW1lPTEzOTMyMDE1NjkmY29ubmVjdGlvbl9kYXRhPQ==";

    function sessionConnectedHandler(event) {
        session.publish(publisher);
        subscribeToStreams(event.streams);
    }
    function subscribeToStreams(streams) {
        for (var i = 0; i < streams.length; i++) {
            var stream = streams[i];
            if (stream.connection.connectionId
                   != session.connection.connectionId) {
                session.subscribe(stream);
            }
        }
    }
    function streamCreatedHandler(event) {
        subscribeToStreams(event.streams);
    }

    var publisher = TB.initPublisher(apiKey);
    var session = TB.initSession(sessionId);

    session.connect(apiKey, token);
    session.addEventListener("sessionConnected",
                             sessionConnectedHandler);

    session.addEventListener("streamCreated",
                             streamCreatedHandler);
</script>
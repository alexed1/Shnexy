namespace Data.Migrations
{
    using System;
    using System.Data.Entity.Migrations;
    
    public partial class FixForeignKeys : DbMigration
    {
        public override void Up()
        {
            DropForeignKey("dbo.Emails", "EmailStatus", "dbo._EmailStatusTemplate");
            DropForeignKey("dbo.Recipients", "EmailID", "dbo.Emails");
            DropForeignKey("dbo.Events", "EventStatus", "dbo._EventStatusTemplate");
            DropForeignKey("dbo.Attendees", "EmailAddressID", "dbo.EmailAddresses");
            DropForeignKey("dbo.Attendees", "ParticipationStatus", "dbo._ParticipationStatusTemplate");
            DropForeignKey("dbo.Recipients", "EmailAddressID", "dbo.EmailAddresses");
            DropForeignKey("dbo.Recipients", "EmailParticipantType", "dbo._EmailParticipantTypeTemplate");
            DropForeignKey("dbo.Negotiations", "NegotiationState", "dbo._NegotiationStateTemplate");
            DropForeignKey("dbo.Questions", "QuestionStatus", "dbo._QuestionStatusTemplate");
            DropForeignKey("dbo.Answers", "AnswerStatus", "dbo._AnswerStatusTemplate");
            DropForeignKey("dbo.Emails", "InvitationType", "dbo._InvitationTypeTemplate");
            DropForeignKey("dbo.CommunicationConfigurations", "CommunicationType", "dbo._CommunicationTypeTemplate");
            DropForeignKey("dbo.TrackingStatuses", "TrackingStatus", "dbo._TrackingStatusTemplate");
            DropForeignKey("dbo.TrackingStatuses", "TrackingType", "dbo._TrackingTypeTemplate");
            DropForeignKey("dbo.Concepts", "RequestId", "dbo.Emails");
            DropForeignKey("dbo.QuestionResponses", "AnswerID", "dbo.Answers");
            DropForeignKey("dbo.InvitationResponses", "AttendeeId", "dbo.Attendees");
            DropIndex("dbo.Emails", new[] { "EmailStatus" });
            DropIndex("dbo.Events", new[] { "EventStatus" });
            DropIndex("dbo.Attendees", new[] { "EmailAddressID" });
            DropIndex("dbo.Attendees", new[] { "ParticipationStatus" });
            DropIndex("dbo.Recipients", new[] { "EmailID" });
            DropIndex("dbo.Recipients", new[] { "EmailAddressID" });
            DropIndex("dbo.Recipients", new[] { "EmailParticipantType" });
            DropIndex("dbo.Negotiations", new[] { "NegotiationState" });
            DropIndex("dbo.Questions", new[] { "QuestionStatus" });
            DropIndex("dbo.Answers", new[] { "AnswerStatus" });
            DropIndex("dbo.CommunicationConfigurations", new[] { "CommunicationType" });
            DropIndex("dbo.TrackingStatuses", new[] { "TrackingType" });
            DropIndex("dbo.TrackingStatuses", new[] { "TrackingStatus" });
            DropIndex("dbo.Concepts", new[] { "RequestId" });
            DropIndex("dbo.QuestionResponses", new[] { "AnswerID" });
            DropIndex("dbo.InvitationResponses", new[] { "AttendeeId" });
            AlterColumn("dbo.Emails", "ConversationId", c => c.Int());

            Sql(@"UPDATE [dbo].[Emails] SET ConversationId = NULL WHERE ConversationID = 0");

            AlterColumn("dbo.Emails", "EmailStatus", c => c.Int());
            AlterColumn("dbo.InvitationResponses", "AttendeeId", c => c.Int());
            AlterColumn("dbo.Events", "EventStatus", c => c.Int());
            AlterColumn("dbo.Attendees", "EmailAddressID", c => c.Int());
            AlterColumn("dbo.Attendees", "ParticipationStatus", c => c.Int());
            AlterColumn("dbo.Recipients", "EmailID", c => c.Int());
            AlterColumn("dbo.Recipients", "EmailAddressID", c => c.Int());
            AlterColumn("dbo.Recipients", "EmailParticipantType", c => c.Int());
            AlterColumn("dbo.Negotiations", "NegotiationState", c => c.Int());
            AlterColumn("dbo.Questions", "QuestionStatus", c => c.Int());
            AlterColumn("dbo.Answers", "AnswerStatus", c => c.Int());
            AlterColumn("dbo.CommunicationConfigurations", "CommunicationType", c => c.Int());
            AlterColumn("dbo.TrackingStatuses", "TrackingType", c => c.Int());
            AlterColumn("dbo.TrackingStatuses", "TrackingStatus", c => c.Int());
            AlterColumn("dbo.Concepts", "RequestId", c => c.Int());
            AlterColumn("dbo.QuestionResponses", "AnswerID", c => c.Int());
            CreateIndex("dbo.Emails", "ConversationId");
            CreateIndex("dbo.Emails", "EmailStatus");
            CreateIndex("dbo.Events", "EventStatus");
            CreateIndex("dbo.Attendees", "EmailAddressID");
            CreateIndex("dbo.Attendees", "ParticipationStatus");
            CreateIndex("dbo.Recipients", "EmailID");
            CreateIndex("dbo.Recipients", "EmailAddressID");
            CreateIndex("dbo.Recipients", "EmailParticipantType");
            CreateIndex("dbo.Negotiations", "NegotiationState");
            CreateIndex("dbo.Questions", "QuestionStatus");
            CreateIndex("dbo.Answers", "AnswerStatus");
            CreateIndex("dbo.CommunicationConfigurations", "CommunicationType");
            CreateIndex("dbo.TrackingStatuses", "TrackingType");
            CreateIndex("dbo.TrackingStatuses", "TrackingStatus");
            CreateIndex("dbo.Concepts", "RequestId");
            CreateIndex("dbo.QuestionResponses", "AnswerID");
            CreateIndex("dbo.InvitationResponses", "AttendeeId");
            AddForeignKey("dbo.Emails", "ConversationId", "dbo.BookingRequests", "Id");
            AddForeignKey("dbo.Emails", "EmailStatus", "dbo._EmailStatusTemplate", "Id");
            AddForeignKey("dbo.Recipients", "EmailID", "dbo.Emails", "Id");
            AddForeignKey("dbo.Events", "EventStatus", "dbo._EventStatusTemplate", "Id");
            AddForeignKey("dbo.Attendees", "EmailAddressID", "dbo.EmailAddresses", "Id");
            AddForeignKey("dbo.Attendees", "ParticipationStatus", "dbo._ParticipationStatusTemplate", "Id");
            AddForeignKey("dbo.Recipients", "EmailAddressID", "dbo.EmailAddresses", "Id");
            AddForeignKey("dbo.Recipients", "EmailParticipantType", "dbo._EmailParticipantTypeTemplate", "Id");
            AddForeignKey("dbo.Negotiations", "NegotiationState", "dbo._NegotiationStateTemplate", "Id");
            AddForeignKey("dbo.Questions", "QuestionStatus", "dbo._QuestionStatusTemplate", "Id");
            AddForeignKey("dbo.Answers", "AnswerStatus", "dbo._AnswerStatusTemplate", "Id");
            AddForeignKey("dbo.Emails", "InvitationType", "dbo._InvitationTypeTemplate", "Id");
            AddForeignKey("dbo.CommunicationConfigurations", "CommunicationType", "dbo._CommunicationTypeTemplate", "Id");
            AddForeignKey("dbo.TrackingStatuses", "TrackingStatus", "dbo._TrackingStatusTemplate", "Id");
            AddForeignKey("dbo.TrackingStatuses", "TrackingType", "dbo._TrackingTypeTemplate", "Id");
            AddForeignKey("dbo.Concepts", "RequestId", "dbo.Emails", "Id");
            AddForeignKey("dbo.QuestionResponses", "AnswerID", "dbo.Answers", "Id");
            AddForeignKey("dbo.InvitationResponses", "AttendeeId", "dbo.Attendees", "Id");
        }
        
        public override void Down()
        {
            DropForeignKey("dbo.InvitationResponses", "AttendeeId", "dbo.Attendees");
            DropForeignKey("dbo.QuestionResponses", "AnswerID", "dbo.Answers");
            DropForeignKey("dbo.Concepts", "RequestId", "dbo.Emails");
            DropForeignKey("dbo.TrackingStatuses", "TrackingType", "dbo._TrackingTypeTemplate");
            DropForeignKey("dbo.TrackingStatuses", "TrackingStatus", "dbo._TrackingStatusTemplate");
            DropForeignKey("dbo.CommunicationConfigurations", "CommunicationType", "dbo._CommunicationTypeTemplate");
            DropForeignKey("dbo.Emails", "InvitationType", "dbo._InvitationTypeTemplate");
            DropForeignKey("dbo.Answers", "AnswerStatus", "dbo._AnswerStatusTemplate");
            DropForeignKey("dbo.Questions", "QuestionStatus", "dbo._QuestionStatusTemplate");
            DropForeignKey("dbo.Negotiations", "NegotiationState", "dbo._NegotiationStateTemplate");
            DropForeignKey("dbo.Recipients", "EmailParticipantType", "dbo._EmailParticipantTypeTemplate");
            DropForeignKey("dbo.Recipients", "EmailAddressID", "dbo.EmailAddresses");
            DropForeignKey("dbo.Attendees", "ParticipationStatus", "dbo._ParticipationStatusTemplate");
            DropForeignKey("dbo.Attendees", "EmailAddressID", "dbo.EmailAddresses");
            DropForeignKey("dbo.Events", "EventStatus", "dbo._EventStatusTemplate");
            DropForeignKey("dbo.Recipients", "EmailID", "dbo.Emails");
            DropForeignKey("dbo.Emails", "EmailStatus", "dbo._EmailStatusTemplate");
            DropForeignKey("dbo.Emails", "ConversationId", "dbo.BookingRequests");
            DropIndex("dbo.InvitationResponses", new[] { "AttendeeId" });
            DropIndex("dbo.QuestionResponses", new[] { "AnswerID" });
            DropIndex("dbo.Concepts", new[] { "RequestId" });
            DropIndex("dbo.TrackingStatuses", new[] { "TrackingStatus" });
            DropIndex("dbo.TrackingStatuses", new[] { "TrackingType" });
            DropIndex("dbo.CommunicationConfigurations", new[] { "CommunicationType" });
            DropIndex("dbo.Answers", new[] { "AnswerStatus" });
            DropIndex("dbo.Questions", new[] { "QuestionStatus" });
            DropIndex("dbo.Negotiations", new[] { "NegotiationState" });
            DropIndex("dbo.Recipients", new[] { "EmailParticipantType" });
            DropIndex("dbo.Recipients", new[] { "EmailAddressID" });
            DropIndex("dbo.Recipients", new[] { "EmailID" });
            DropIndex("dbo.Attendees", new[] { "ParticipationStatus" });
            DropIndex("dbo.Attendees", new[] { "EmailAddressID" });
            DropIndex("dbo.Events", new[] { "EventStatus" });
            DropIndex("dbo.Emails", new[] { "EmailStatus" });
            DropIndex("dbo.Emails", new[] { "ConversationId" });
            AlterColumn("dbo.QuestionResponses", "AnswerID", c => c.Int(nullable: false));
            AlterColumn("dbo.Concepts", "RequestId", c => c.Int(nullable: false));
            AlterColumn("dbo.TrackingStatuses", "TrackingStatus", c => c.Int(nullable: false));
            AlterColumn("dbo.TrackingStatuses", "TrackingType", c => c.Int(nullable: false));
            AlterColumn("dbo.CommunicationConfigurations", "CommunicationType", c => c.Int(nullable: false));
            AlterColumn("dbo.Answers", "AnswerStatus", c => c.Int(nullable: false));
            AlterColumn("dbo.Questions", "QuestionStatus", c => c.Int(nullable: false));
            AlterColumn("dbo.Negotiations", "NegotiationState", c => c.Int(nullable: false));
            AlterColumn("dbo.Recipients", "EmailParticipantType", c => c.Int(nullable: false));
            AlterColumn("dbo.Recipients", "EmailAddressID", c => c.Int(nullable: false));
            AlterColumn("dbo.Recipients", "EmailID", c => c.Int(nullable: false));
            AlterColumn("dbo.Attendees", "ParticipationStatus", c => c.Int(nullable: false));
            AlterColumn("dbo.Attendees", "EmailAddressID", c => c.Int(nullable: false));
            AlterColumn("dbo.Events", "EventStatus", c => c.Int(nullable: false));
            AlterColumn("dbo.InvitationResponses", "AttendeeId", c => c.Int(nullable: false));
            AlterColumn("dbo.Emails", "EmailStatus", c => c.Int(nullable: false));
            AlterColumn("dbo.Emails", "ConversationId", c => c.Int(nullable: false));
            CreateIndex("dbo.InvitationResponses", "AttendeeId");
            CreateIndex("dbo.QuestionResponses", "AnswerID");
            CreateIndex("dbo.Concepts", "RequestId");
            CreateIndex("dbo.TrackingStatuses", "TrackingStatus");
            CreateIndex("dbo.TrackingStatuses", "TrackingType");
            CreateIndex("dbo.CommunicationConfigurations", "CommunicationType");
            CreateIndex("dbo.Answers", "AnswerStatus");
            CreateIndex("dbo.Questions", "QuestionStatus");
            CreateIndex("dbo.Negotiations", "NegotiationState");
            CreateIndex("dbo.Recipients", "EmailParticipantType");
            CreateIndex("dbo.Recipients", "EmailAddressID");
            CreateIndex("dbo.Recipients", "EmailID");
            CreateIndex("dbo.Attendees", "ParticipationStatus");
            CreateIndex("dbo.Attendees", "EmailAddressID");
            CreateIndex("dbo.Events", "EventStatus");
            CreateIndex("dbo.Emails", "EmailStatus");
            AddForeignKey("dbo.InvitationResponses", "AttendeeId", "dbo.Attendees", "Id", cascadeDelete: true);
            AddForeignKey("dbo.QuestionResponses", "AnswerID", "dbo.Answers", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Concepts", "RequestId", "dbo.Emails", "Id", cascadeDelete: true);
            AddForeignKey("dbo.TrackingStatuses", "TrackingType", "dbo._TrackingTypeTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.TrackingStatuses", "TrackingStatus", "dbo._TrackingStatusTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.CommunicationConfigurations", "CommunicationType", "dbo._CommunicationTypeTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Emails", "InvitationType", "dbo._InvitationTypeTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Answers", "AnswerStatus", "dbo._AnswerStatusTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Questions", "QuestionStatus", "dbo._QuestionStatusTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Negotiations", "NegotiationState", "dbo._NegotiationStateTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Recipients", "EmailParticipantType", "dbo._EmailParticipantTypeTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Recipients", "EmailAddressID", "dbo.EmailAddresses", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Attendees", "ParticipationStatus", "dbo._ParticipationStatusTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Attendees", "EmailAddressID", "dbo.EmailAddresses", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Events", "EventStatus", "dbo._EventStatusTemplate", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Recipients", "EmailID", "dbo.Emails", "Id", cascadeDelete: true);
            AddForeignKey("dbo.Emails", "EmailStatus", "dbo._EmailStatusTemplate", "Id", cascadeDelete: true);
        }
    }
}
